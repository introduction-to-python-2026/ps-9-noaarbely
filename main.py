# 1. Load the dataset:import pandas as pddf = pd.read_csv("penguins.csv")df.head()# 2. Select features:import seaborn as snsimport matplotlib.pyplot as plt# Drop rows with missing 'sex' values for the pairplot, as it's the target variabledf_cleaned = df.dropna(subset=['sex'])# Select featuresx = df_cleaned[['bill_depth_mm', 'body_mass_g']]y = df_cleaned['sex']  # Changed to Series instead of DataFrame# Visualize relationshipssns.pairplot(df_cleaned, vars=['bill_depth_mm', 'body_mass_g'], hue='sex')plt.suptitle('Pair Plot of Numerical Features by Sex', y=1.02)plt.show()# 3. Scale the data:from sklearn.preprocessing import MinMaxScalerscaler = MinMaxScaler()x_scale = scaler.fit_transform(x)  # Normalize the data# 4. Split the data:from sklearn.model_selection import train_test_splitx_train, x_test, y_train, y_test = train_test_split(x_scale, y, test_size=0.2, random_state=42)  # Added random_state for reproducibility# 5. Choose a model:from sklearn.neighbors import KNeighborsClassifierdt = KNeighborsClassifier(n_neighbors=3)dt.fit(x_train, y_train)# 6. Test the accuracy:from sklearn.metrics import accuracy_scorey_predict = dt.predict(x_test)accuracy = accuracy_score(y_test, y_predict)print(f"Model Accuracy: {accuracy}")# 7. Save and upload the model:import joblibjoblib.dump(dt, 'knn_penguins.joblib')# Example config.yaml content (for your reference)config_content = """selected_features: ["bill_depth_mm", "body_mass_g"]  path: "knn_penguins.joblib"  """with open('config.yaml', 'w') as f:    f.write(config_content)# Load model to verifymodel = joblib.load('knn_penguins.joblib')
